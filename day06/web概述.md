## web概述

### 			WEB概念

​						WEB，在英语中web即表示网页的意思，它用于表示Internet主机上供外界访问的资源。

### 			web资源分类

#### 							静态web资源（如html 页面）：

```
指web页面中供人们浏览的数据始终是不变。如Html、CSS、javaScript
```

#### 							动态web资源：

```
指web页面中供人们浏览的数据是由程序产生的，不同时间点访问web页面看到的内容各不相同。如JSP/Servlet、ASP、PHP

在Java中，动态web资源开发技术统称为Javaweb，我们课程的重点也是教大家如何使用Java技术开发动态的web资源，即动态web页面。
```

### 			Web服务器

Servlet容器、web容器、web服务器

#### 							Servlet容器：

```
java中的动态资源开发技术为Servlet/JSP,sun公司定义了Servlet/JSP的技术规范，遵循这样规范就可以写出对应的Servlet、JSP程序，但是Servlet、JSP本身不能直接运行，需要运行他们的环境，于是有不同的厂商分别按照Servlet/JSP规范的要求开发了对应的运行环境，这样的能够运行Servlet/JSP的环境就叫做Servlet容器。
```

#### 							web容器：

```
web资源按照一定的规则整合起来组成能够被web访问的应用程序就叫做web应用，web应用运行也需要一定的环境。能够运行web应用的环境叫做web容器。

web容器的概念通常要大于Servlet容器，Servlet容器通常都是web容器，但是web容器不一定是Servlet容器，因为运行ASP、PHP的服务器是web容器，但是不能运行Servlet所以不能叫Servlet容器。
```

#### 							web服务器

```
web容器/Servlet容器具体来说就是web服务器，学习web开发，需要先安装一台web服务器，然后再在web服务器中开发相应的web资源，供用户使用浏览器访问。
```

注意⚠️：这里所说的服务器不是指服务器硬件资源，而是指服务器软件。

### 常见的web服务器

#### 		WebLogic

WebLogic是BEA公司的产品，是目前应用最广泛的Web服务器，支持J2EE规范。

#### 		WebSphere

WebSphere是IBM公司的产品，支持J2EE规范，使用的也不少。

#### 		Tomcat 

在小型的应用系统或者有特殊需要的系统中，可以使用一个免费的Web服务器:Tomcat，该服务器支持全部JSP以及Servlet规范

虽然是免费开源的服务器，并且不能完全支持J2EE规范，但是它免费、轻量等特性让他仍然十分受到欢迎。我们学习阶段就是使用tomcat作为服务器。

### tomcat的下载安装配置

#### 		安装tomcat

```
将解压版.zip包拷贝到要安装的目录下，解压。

注意，在tomcat的安装目录中不允许有空格和中文字符! 其实不止tomcat，绝大部分开发相关的软件都对中文和空格支持有问题，所以以后在安装任何软件时都要养成一个习惯：路径中绝对不要有中文和空格！

打开[tomcat]/bin目录，发现其中包含大量.bat程序，找到startup.bat，双击启动发现cmd窗口一闪而过。这是因为启动报错后cmd窗口关闭了自己，所以我们只看到一闪而过的窗口。

在windows的命令中启动cmd窗口，进入[tomcat]/bin目录，执行startup.bat,发现报错简单阅读后发现提示，没有配置JAVA_HOME环境变量，因为tomcat本身也是java写的程序,运行需要jdk的支持，所以需要通过JAVA_HOME环境变量通知tomcat启动时用的jdk在哪。

要注意的是，不同版本的tomcat要求的jdk的版本是不相同的。

tomcat6 需要 jdk5.0以上版本。

tomcat7 需要 jdk6.0以上版本。

tomcat8 需要jdk7.0以上版本。

所以只需要配置环境变量JAVA_HOME指向tomcat安装的根目录即可再次启动tomcat，发现可以正常工作。

看到类似有启动时间说明tomcat正常的启动起来了。

打开浏览器，访问 HYPERLINK "http://localhost:8080可以看到一只猫
```

#### 安装常见问题

##### （1）端口占用问题: 

```
可以在cmd窗口中使用netstat -ano命令查询出哪个程序占用了端口,结束这个程序后再启动tomcat即可
```

##### （2）Catalina_home环境变量:

```
用来指定启动的tomcat的位置,如果没有配置过这个环境变量,则在哪个tomcat中启动,则该tomcat被启动,如果这个环境变量被配置过,无论在哪个tomcat中启动,最终启动的都是该环境变量指定的tomcat
```

##### 关闭服务器

```
在[tomcat]/bin 目录下 双击shutdown.bat即可关闭服务器。

直接关闭tomcat窗口也可快速关闭服务器，但是这种做法服务器没有执行正常的关闭流程，有时会造成下次启动报错，遇到这种情况只要再执行一次shutdonw.bat即可解决问题。
```

#### tomcat的目录结构

| 目录结构 | 介绍                                                         |
| -------- | ------------------------------------------------------------ |
| bin      | 存放tomcat启动和关闭用的bat文件                              |
| conf     | 存放tomcat配置文件的目录                                     |
| lib      | 存放tomcat运行时依赖的jar包                                  |
| logs     | 存放tomcat运行时产生的日志文件的                             |
| temp     | tomcat自己用来存放运行过程中产生的临时文件的目录,不需要我们管理,tomcat自动管理 |
| webapps  | 这是和开发人员关系最大的目录,是用来存放web应用的目录,我们开发的web资源最终要保存在这个目录下,外界就可以访问了 |
| work     | tomcat的工作目录,tomcat在运行时产生的工作文件存放在这个目录  |

###### conf/server.xml--tomcat的核心配置文件

练习：修改tomcat/conf/server.xml Connector 中的 prot 将tomcat监听的端口号从8080 转为 80



### tomcat中的基本概念

#### 虚拟主机

tomcat中可以配置管理多个网站，外界在访问这些网站时，并不知道这些网站是运行在同一个tomcat中的，感觉起来就像他们各自运行在各自的虚拟出来的主机中一样，所以将一个网站交给tomcat去管理的过程称为为tomcat配置一台虚拟主机。

#### web应用

一个虚拟主机包含着许多web资源，但这些web资源不能直接交给虚拟主机管理，需要按照功能将web资源按照一定的目录结构组织成web应用再交给虚拟主机去管理

#### 虚拟路径映射

将web应用交给虚拟主机管理，为web应用真实路径配置一个对外访问的虚拟的路径的过程叫做web应用的虚拟路径映射。

web资源需要按照一定方式组织成web应用才能交给虚拟主机去管理。web应用的目录结构如下：

```
mail --- web应用所在的目录

	 |

	 |--html css js jsp  

	 |

	 |--WEB-INF		

		|--classes 

		|

		|--lib 

		|

		|--web.xml 
```

##### （1）静态web资源和jsp可以放置在web应用的根目录下,在web应用根目录下的资源,浏览器可以直接访问

##### （2）WEB-INF目录可以没有,但是一旦有了,必须符合结构,放置在这个目录中的资源会被保护起来,浏览器是没有办法直接访问的

##### （3）WEB-INF/classes存放动态web资源的 class文件的

##### （4）WEB-INF/lib 存放class们依赖的jar包的

##### （5）WEB-INF/web.xml整个web应用的核心配置文件,这个web应的所有配置都要在这里进行 (配置web应用的主页 配置Servlet映射 配置监听器 配置过滤器....)

练习：新建game应用，包含index.html 和 news.html，并在web.xml中将index.html配置为主页。

#### web应用配置虚拟路径映射的三种方式

##### 	方式1

```
在server.xml中的<Host>标签中配置<Context>标签，其中的path属性指定虚拟路径(浏览器访问的路径)，docBase指向真实的web应用目录。

注意，这种方式配置的web应用需要重启服务器后才会生效。

如果将path配置为空，则当前web应用称为虚拟主机的缺省web应用。
```

##### 	方式2

```
在[tomcat]/conf/[engin]/[host]目录下新建一个xml文件，其中文件名为成当前web应用虚拟路径，在xml文件的内部,用<Context>标签配置docBase指定真实路径，注意这种配置方式不需要指定path虚拟路径，因为文件名就是path.

这种方式不需要重启服务器即可起作用。

如果将xml文件名改为ROOT.xml则当前web应用成为当前虚拟主机的缺省web应用。
```

##### 	方式3

```
直接将web应用放置到虚拟主机管理的目录中。虚拟主机自动管理该目录，文件夹的名字成为web应用的虚拟路径。

这种方式不需要重启服务器即可起作用。

如果将文件夹的名字改为ROOT则当前web应用成为缺省web应用。

localhost虚拟主机管理的是webapps目录，所以将应用放置到webapps目录下通过localhost主机就可以直接访问了。
```

#### 配置虚拟主机

想要配置一台虚拟主机，只需要在[tomcat]/server.xml的<Engin>标签下配置<Host>标签即可：

```
<Host name="主机名" appBase="虚拟主机管理的目录"></Host>
```

其中“虚拟主机管理的目录”是为当前虚拟主机配置一个虚拟主机管理的目录，可以将web应用放置到该目录下，虚拟主机就会自动管理该web应用了。

此时通过浏览器访问http://www.baidu.com发现无法访问。

这是因为还没有配置dns服务器。

##### 	DNS服务器

```
网络中是通过ip来区分不同的主机的，浏览器如何知道www.baidu.com对应的主机的ip呢？这里就是dns服务器在起作用了。

互联网上有一些专门将域名翻译为对应主机ip的服务器叫做dns服务器（域名解析服务器）专门进行域名到ip的翻译工作。

如果我们想要让www.baidu.com能够访问当前虚拟主机，还需要到dns服务器中进行配置，将www.baidu.com和本机ip地址进行绑定才可以。

但是dns是不能随意修改的！那我们如何进行测试呢？

Hosts文件

好在c:/windwos/system32/drivers/etc/hosts文件可以模拟dns的功能，浏览器在访问dns之前会首先检查该文件，如果这个文件中配置过域名ip映射，则会直接使用而不再去找dns服务器了。所以我们可以在hosts文件中进行配置
再通过浏览器访问，发现成功访问了我们配置的虚拟主机中的web应用。
```

###### 综合练习

配置www.163.com虚拟主机,以三种方式配置web应用,并选择一种配置为缺省web应用,并且配置web应用的主页,最终实现,直接访问www.163.com时能够显示主页的内容。

##### 其他相关

###### 	打war包

```
web应用是一个文件夹，可以将文件夹形式的web应用打成一个war包，减少体积同时更方便操作。

在cmd窗口中进入应用目录，使用jar -cvf news.war  即可将当前目录下的内容打成 news.war包

将war包直接丢到虚拟主机管理目录下，发现会自动解压成web应用。十分方便。
```

###### 	通用web.xml 

```
在[tomcat]/conf目录下有一个web.xml文件，整个服务器内所有的web.xml可以认为继承自该web.xml。所以如果有一些通用配置不希望每次都具体配置一次，可以在这里配置。
```



### HTTP概述

#### http概述

##### 		什么是http协议

```
网络通信中存在不同的主机、网络、设备，需要遵循一套统一的通信协议才可以有效的进行通信。

HTTP协议就是一套基于tcp/ip协议的应用层协议 

它规定了客户端（通常是浏览器）和服务器之间的通信方式。
```

#### 基本原则

#### 特点

```
HTTP协议基于请求响应模型

一次请求对应一次响应

请求只能是客户端发出服务器端只能被动的等待请求，做出响应。
```

#### HTTP协议详解

​		HTTP协议分为HTTP请求和HTTP响应

#### HTTP请求

##### 		HTTP请求结构

一个典型的HTTP请求分为 一个请求行 若干请求头 一个空行 实体内容

###### 		一个请求行

```
GET /books/java.html HTTP/1.1	

请求方式:一共有7种请求方式（:GET、POST、HEAD、OPTIONS、PUT、DELETE和TARCE）,但是真正使用的只有两种 GET POST，其他五种很少使用。

POST和GET之间的区别:请求参数的提交方式不同,GET请求请求参数位于URL后面,所能传输的请求参数最大不超过1KB,安全性比较低.POST提交请求参数位于请求的实体内容中,没有大小限制,也比较安全

只有当一个表单method明确被指定为POST时,才是POST提交,其他情况下都是GET提交.

请求的资源:/books/java.html

所遵循的协议:HTTP/1.1
```

###### 		若干请求头 

```
http协议中请求头非常多，下面列出常见的请求头及其功能：

Accept: text/html,image/  

-- 通知服务器当前浏览器可以接受那些格式的数据

Accept-Charset: ISO-8859-1  

-- 浏览器可以接受的字符集编码

Accept-Encoding: gzip,compress 

-- 浏览器可以接受的压缩格式

Accept-Language: en-us,zh-cn  

-- 浏览器接受的语言环境,和国际化相关的头

Host: www.tedu.cn:80  

-- 需要访问的虚拟主机的名称

If-Modified-Since: Fri, 17 Feb 2017 18:23:51 GMT 

-- 这是和缓存机制相关的头

Referer: http://www.tedu.cn/index.jsp 

-- 这是和防盗链相关的头,对当前资源的访问来自哪个页面的超链接

User-Agent: Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0) 			-- 客户端的基本信息

Cookie 

-- 和cookie相关的头

Connection: close/Keep-Alive 

-- 是否继续保持连接  

Date: Fri, 17 Feb 2017 18:23:51 GMT 

-- 当前发送请求的时间	
```

###### 		一个空行

空行的作用为分割请求头和实体内容。

###### 		实体内容

实体内容中为需要传递给服务器的内容数据。

#### HTTP响应：

##### 		HTTP响应结构

一个典型的HTTP响应分为 一个状态行 若干响应头 一个空行 实体内容。

###### 一个状态行

```
HTTP/1.1 200 OK

所遵循的协议号：HTTP目前分为1.0和1.1两个版本，其中1.0每次请求都要新建连接，响应结束后断开连接，连接不会复用效率较低。1.1版本在一次请求结束后会保持连接一段时间，下次再次请求时可以复用连接，提高了效率。

状态码:是3位的十进制数,通过不同的状态码表示服务器对请求的不同处理结果。响应状态码分为5类。
```

| 状态码   |                                                              |
| :------- | ------------------------------------------------------------ |
| 100～199 | 表示接收的请求正在处理                                       |
| 200～299 | 表示成功接收请求并已完成整个处理过程，常用200                |
| 300～399 | 需要进行附加操作以完成请求。例如: 请求的资源已经移动一个新地址，常用302、307和304 |
| 400～499 | 客户端的请求有错误，常用404                                  |
| 500～599 | 服务器端出现错误，常用 500                                   |



200 表示成功处理完成请求

302 表示请求重定向

304 表示通知浏览器使用缓存中的资源

307 表示通知浏览器使用缓存中的资源

404 找不到资源

500 服务器端错误

原因叙述：一个字符串描述原因。

若干响应头  

http协议中响应头头非常多，下面列出常见的响应头及其功能：

Location: http://www.tedu.cn/index.jsp  

-- 配合302使用实现请求重定向

Server:apache tomcat 

-- 服务器的基本信息

Content-Encoding: gzip  

-- 服务器发送的数据使用的压缩格式

Content-Length: 80 

-- 服务器发送的数据的大小

Content-Language: zh-cn 

--服务器发送的数据使用的语言环境 国际化相关的头

Content-Type: text/html; charset=GB2312 

-- 服务器发送的数据是什么格式的,如果是字符格式的数据,则还可以通知服务器发送的数据使用的是什么编码,浏览器会根据这个头指定的编码决定使用哪个编码来打开收到的数据

Last-Modified: Fri, 17 Feb 2017 18:24:11 GMT 

-- 和缓存相关的头

Refresh: 1;url=http://www.tedu.cn 

-- 定时刷新相关的头,通知浏览器,过几秒后自动刷新访问哪个地址

Content-Disposition: attachment;filename=aaa.zip 

-- 通知浏览器以附件的形式打开发送过去的数据,是和文件下载相关的头

Set-Cookie:SS=Q0=5Lb_nQ; path=/search 

-- 和Cookie相关的头

Expires: -1 

-- 通知浏览器是否缓存

Cache-Control: no-cache  

-- 通知浏览器是否缓存

Pragma: no-cache  

-- 通知浏览器是否缓存

--之所以一个功能有三个头,是因为历史原因.所以为了网页的兼容性考虑,通常这三个头要一起使用

Connection: close/Keep-Alive  

-- 是否保持连接

Date: Fri, 17 Feb 2017 18:24:11 GMT  

-- 响应时的时间



一个空行

空行的作用为分割响应头和实体内容。

实体内容

实体内容中为服务器发送回的内容数据。